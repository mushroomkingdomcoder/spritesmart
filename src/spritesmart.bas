#RetroDevStudio.MetaData.BASIC:2049,BASIC V2,uppercase,10,10
1 PRINT"SPRITESMART V1.0":GOTO100
2 PRINT"SPRITESMART V1.0":PRINT"LOADING DATA..."
3 DB=16384:SB=18432:PB=19448:C=55296:CN=C-SB:V=53248:RV=160:CC=SB+186
4 B1=SB+81:B2=C+81:ND=0:FF=0
5 DIM T(7,40),GS(4),LO(10),MS$(19),CN$(15),SC(7)
6 GS(0)=0:GS(1)=11:GS(2)=12:GS(3)=15:GS(4)=1:FORI=0TO7:SC(I)=8+I:NEXT:A1=6:A2=7
7 GOSUB324
8 FORI=1TO40:READT(0,I):NEXT:T(0,0)=40
9 FORI=1TO28:READT(1,I):NEXT:T(1,0)=28
10 FORI=1TO16:READT(2,I):NEXT:T(2,0)=16
11 FORI=1TO8:READT(3,I):NEXT:T(3,0)=8
12 FORI=1TO16:READT(4,I):NEXT:T(4,0)=16
13 FORI=1TO26:READT(5,I):NEXT:T(5,0)=26
14 FORI=1TO28:READT(6,I):NEXT:T(6,0)=28
15 FORI=1TO22:READT(7,I):NEXT:T(7,0)=22
16 FORI=0TO10:READLO(I):NEXT
17 FORI=0TO15:READCN$(I):NEXT
18 PRINT"DONE.":GOSUB130:RF=1
19 GETZ$:K=ASC(Z$+CHR$(0)):POKELC,CL:POKELC+CF,CL
20 IFZ$=""THENCX=0:CY=-1:GOTO40
21 IFZ$=""THENCX=1+CF:CY=0:GOTO40
22 IFZ$=""THENCX=0:CY=1:GOTO40
23 IFZ$=""THENCX=-1-CF:CY=0:GOTO40
24 IFZ$=" "THEN45
25 IFK>48ANDK<57ANDNS>K-50THENCS=K-49:CL=SC(CS):GOTO19
26 IFK>132ANDK<137ANDNS>=(K-133)*2THENCS=(K-133)*2:CL=SC(CS):GOTO63
27 IFK>136ANDK<141ANDNS>=(K-137)*2+1THENCS=(K-137)*2+1:CL=SC(CS):GOTO63
28 IFZ$="9"ANDCF=1THENCL=A1:GOTO19
29 IFZ$="0"ANDCF=1THENCL=A2:GOTO19
30 IFZ$="+"ANDCF=1THENCL=A1:GOTO63
31 IFZ$="-"ANDCF=1THENCL=A2:GOTO63
32 IFZ$="E"THENFI=0:GOSUB280:PRINTMS$(MS);:GOTO19
33 IFZ$="S"THENGOTO209
34 IFZ$="L"THENGOTO209
35 IFZ$="N"THEN85
36 IFZ$="Q"THEN87
37 IFZ$="P"THEN92
38 IFZ$=""THEN96
39 GOTO19
40 IFXX+CX>-1ANDXX+CX<24THENXX=XX+CX
41 IFYY+CY>-1ANDYY+CY<21THENYY=YY+CY
42 POKELC,UC:POKELC+CF,UC
43 LC=B2+YY*40+XX:UC=(PEEK(LC)AND15)
44 GOTO19
45 DT=CL:K=INT(XX/8):BY=DB+(FM+CS)*64+YY*3+K:I1=ABS(7-(XX-K*8))
46 IFCF=1THENI2=I1-1
47 IFUC<>BGTHENDT=BG:IFUC<>SC(CS)ANDNS>0THEN58
48 IFEF=1THENDT=BG
49 ONCF+1GOTO50,52
50 IFDT=SC(CS)THENPOKEBY,PEEK(BY)OR2I1:GOTO56
51 POKEBY,PEEK(BY)AND(255-2I1):GOTO56
52 IFDT=SC(CS)THENPOKEBY,PEEK(BY)OR2I1:POKEBY,PEEK(BY)AND(255-2I2):GOTO56
53 IFDT=A1THENPOKEBY,PEEK(BY)AND(255-2I1):POKEBY,PEEK(BY)OR2I2:GOTO56
54 IFDT=A2THENPOKEBY,PEEK(BY)OR2I1:POKEBY,PEEK(BY)OR2I2:GOTO56
55 POKEBY,PEEK(BY)AND(255-2I1):POKEBY,PEEK(BY)AND(255-2I2)
56 UC=DT:IFEF=0THENGOTO19
57 RETURN
58 ZZ=CS
59 IFUC=A1ORUC=A2THENEF=1:FORI=0TONS:CS=I:GOSUB45:NEXT:EF=0:CS=ZZ:GOTO19
60 FORI=0TONS:IFSC(I)=UCTHENCS=I
61 NEXT:EF=1:GOSUB45:EF=0:CS=ZZ
62 GOTO19
63 OC=CL:NM=CS+49:NC=OC:XP=CC+NC*40
64 IFNC=A1THENNM=57
65 IFNC=A2THENNM=48
66 GETZ$:POKEXP+CN,14*RND(1)+2
67 IFZ$=""THENCP=-40:IC=CP:GOTO71
68 IFZ$=""THENCP=40:IC=CP:GOTO71
69 IFZ$=" "THEN77
70 GOTO66
71 GOSUB75:IFER=1THEN66
72 IF(PEEK(XP+CP))<>32THEN:CP=CP+IC:GOTO71
73 POKEXP,32:XP=XP+CP:POKEXP,NM
74 NC=(XP-CC)/40:GOTO66
75 IFXP+CP<CCORXP+CP>CC+15*40THENER=1: RETURN
76 ER=0:RETURN
77 POKEXP+CN,NC:IFOC=SC(CS)THENSC(CS)=NC:POKEV+39+CS,NC:GOTO80
78 IFOC=A1THENA1=NC:POKEV+37,A1
79 IFOC=A2THENA2=NC:POKEV+38,A2
80 GOSUB284:FORY=0TO20:FORX=0TO23:XP=B2+Y*40+X
81 IF(PEEK(XP)AND15)=OCTHENPOKEXP,NC
82 NEXTX:NEXTY
83 CL=NC
84 PRINTMS$(MS);:GOTO19
85 PRINT"":GOSUB154
86 GOTO19
87 PRINT"EXIT SPRITESMART?   YES OR NO?          ";
88 GOSUB237:IFZ$="Y"THENPRINT"BYE!":     END
89 IFZ$<>"N"THEN88
90 PRINTMS$(MS);
91 GOTO19
92 POKEV+21,ND
93 GOSUB237
94 POKEV+21,0
95 GOTO19
96 MS=MS+1
97 IFMS>9THENMS=0
98 PRINTMS$(MS);
99 GOTO19
100 PRINT"IS THIS YOUR FIRST TIME RUNNING THIS";
101 PRINT"APPLICATION SINCE POWERING-ON YOUR PC?"
102 PRINT"IF SO, THE MEMORY OF YOUR PC REQUIRES"
103 PRINT"INITIALIZING IN ORDER TO ENSURE THIS"
104 PRINT"PROGRAM'S FUNCTIONALITY AND YOUR"
105 PRINT"ENHANCED USER EXPERIENCE WITH SAID"
106 PRINT"SOFTWARE.":PRINT
107 PRINT"THEREFORE, IF THIS IS YOUR FIRST  "
108 PRINT"TIME, PLEASE STRIKE THE  SPACE BAR  TO"
109 PRINT"COMMENCE ITS MEMORY INITIALIZATION.":PRINT
110 PRINT"OTHERWISE,  STRIKE ANY OTHER KEY  OF";
111 PRINT"YOUR CHOOSING TO PROCEED TO THE USEFUL"
112 PRINT"SECTION OF THIS PROGRAM.  ... :)"
113 GETA$:IFA$=""THEN113
114 IFA$<>" "THENGOTO2
115 PRINT"INITIALIZING GRAPHICS MEMORY..."
116 PRINT"PLEASE WAIT APPROXIMATELY 35 SECONDS..."
117 POKE55,0:POKE56,64:CLR
118 POKE56334,PEEK(56334)AND254
119 POKE1,PEEK(1)AND251
120 FORI=0TO2047
121 POKE16384+I,PEEK(53248+I)
122 NEXTI
123 POKE1,PEEK(1)OR4
124 POKE56334,PEEK(56334)OR1
125 POKE56576,6
126 POKE53272,(PEEK(53272)AND240)OR0
127 POKE53272,(PEEK(53272)AND15)OR32
128 POKE648,72:PRINTCHR$(8);
129 GOTO2
130 PRINT"LOAD SPRITE DRAWINGS?":GOSUB237
131 IFZ$="Y"THENZ$="L":GOSUB209
132 PRINT"NIGHT OR DAY MODE?":GOSUB237
133 IFZ$="D"THEN136
134 POKE53280,0:POKE53281,0:POKE646,1: BG=0:FG=1
135 GOTO137
136 POKE53280,1:POKE53281,1:POKE646,0: BG=1:FG=0
137 PRINT"":FORI=1TO100
138 Z=INT(RND(1)*1000):Q=INT(RND(1)*5):IFZ=YORQ=BGTHEN138
139 POKESB+Z,102:POKEC+Z,GS(Q)
140 Z=Y:NEXT
141 SL=SB+124:EL=SL+21:JM=1:DT=64:FF=1:CD=FG:GOSUB244:SL=SL+89:EL=SL+22
142 GOSUB244:PP=SB+208
143 FORI=0TO10:LT=LO(I):IFI=6THENT(0,1)=696:T(2,1)=421:T(4,1)=382
144 GOSUB249:NEXTI:DR=500:GOSUB254
145 PRINT"-A CUSTOM SPRITE EDITOR.":GOSUB254
146 PRINT"PRESS ANY KEY.":GOSUB254
147 MN=-1:SL=SB+831:EL=SL-23:JM=-1:DT=160:ZZ=-1:CD=FG:LC=CD
148 GETZ$:IFZ$<>""THEN154
149 GOSUB256
150 ZZ=ZZ+1:IFZZ/3<>INT(ZZ/3)THEN148
151 MN=MN+1:IFMN>2THENMN=0
152 PRINTMS$(MN);:GOTO148
153 REM
154 PRINT"              "
155 PRINT"MULTI-COLOR OR DETAILED SPRITE FRAME?   ";
156 GETZ$:IFRF=0THENGOSUB256
157 IFZ$="D"THENCF=0:POKEV+28,0:                                      GOTO160
158 IFZ$="M"THENCF=1:POKEV+28,255:POKEV+37,A1:POKEV+38,A2:            GOTO160
159 GOTO156
160 PRINT"LAYERED OR SINGLE SPRITE FRAME?         ";
161 GETZ$:IFRF=0THENGOSUB256
162 IFZ$="S"THENNS=0:GOTO172
163 IFZ$<>"L"THEN161
164 PRINT"NUMBER OF LAYERS? (USE CRSR KEYS)   -1- ";:NS=0:LL=SB+37
165 GETZ$:POKELL,NS+49
166 IFZ$=""THENNS=NS+1
167 IFZ$=""THENNS=NS-1
168 IFZ$=CHR$(13)THEN172
169 IFNS<0THENNS=7
170 IFNS>7THENNS=0
171 GOSUB262:GOTO165
172 GOSUB298:PRINT"2X... HEIGHT, WIDTH, SIZE, NONE ?       ";
173 GETZ$:IFRF=0THENGOSUB256
174 IFZ$="H"THENH=2:W=1:POKEV+23,255:POKEV+29,0:                      GOTO179
175 IFZ$="W"THENH=1:W=2:POKEV+23,0:POKEV+29,255:                      GOTO179
176 IFZ$="S"THENH=2:W=2:POKEV+23,255:POKEV+29,255:                    GOTO179
177 IFZ$="N"THENH=1:W=1:POKEV+23,0:POKEV+29,0:                        GOTO179
178 GOTO173
179 PRINT"                                        ";
180 GOSUB260:INPUT"FRAME NUMBER (48-255 LEGAL)";FM
181 IFFM<48ORFM>255THEN179
182 FORI=0TONS:POKEPB+I,FM+I:NEXT
183 REM
184 PRINT"":DT=42:CD=FG
185 SL=SB+40:EL=SL+25:JM=1:GOSUB239:SL=EL+40:EL=SL+840:JM=40:GOSUB239
186 SL=EL-1:EL=SL-24:JM=-1:GOSUB239:SL=EL-40:EL=SL-800:JM=-40:GOSUB239
187 SL=SB+66:EL=SL+13:JM=1:GOSUB239:SL=EL+40:EL=SL+40:JM=40:GOSUB239
188 SL=EL-1:EL=SL-13:JM=-1:GOSUB239:SL=SL+41:EL=SL+400:JM=40:GOSUB239
189 SL=EL+347:EL=SL+13:JM=1:GOSUB239:SL=EL-40:EL=SL-40:JM=-40:GOSUB239
190 SL=EL-1:EL=SL-13:JM=-1:GOSUB239:SL=SL-39:EL=SL-440:JM=-40:GOSUB239
191 PRINT" HUE PALATTE:"
192 PRINT"":FORI=0TO15:GOSUB265:NEXT
193 PRINT"= DISABLED":POKE646,FG
194 PRINT"=TOGGLE INFO"
195 PRINT"FX=SET SPRITE X HUE:#X=USE SPRITE XHUE:";CHR$(148);" ";
196 PRINT"EDIT OR DISCARD CURRENT SPRITE FRAME?   ";
197 GOSUB237:IFZ$="E"THENGOSUB269:   GOTO200
198 IFZ$<>"D"THEN197
199 FI=0:GOSUB280
200 IFCF=1THENPOKEV+37,A1:POKEV+38,A2:L0=CC+A1*40:L9=CC+A2*40
201 CS=0:XX=0:YY=0:LC=B2:MS=3:FORI=0TONS:POKEV+39+I,SC(I):POKEPB+I,FM+I
202 P=CC+SC(I)*40:POKEP,I+49:POKEP+CN,SC(I):NEXT
203 IFCF=1THENPOKEL0,57:POKEL9,48:POKEL0+CN,A1:POKEL9+CN,A2
204 FORI=0TO14STEP2:POKEV+I,24:POKEV+I+1,50:NEXT:POKEV+16,0
205 CL=SC(CS):UC=BG
206 PRINTMS$(MS);
207 RETURN
208 END
209 PRINT""
210 INPUT"FROM FRAME NUMBER";SI
211 INPUT"TO FRAME NUMBER";EI
212 INPUT"TRACK ON DISK";TT
213 INPUT"SECTOR ON TRACK";SS
214 OPEN 15,8,15,"I":OPEN 2,8,2,"#"
215 CZ=0
216 IFZ$="L"THENGOSUB222
217 IFZ$="S"THENGOSUB229
218 GOSUB295
219 CLOSE2:CLOSE15
220 IFFG=0ANDBG=0THENRETURN
221 PRINT"":GOSUB154:GOTO19
222 PRINT#15,"U1 2 0";TT;SS:PRINT#15,"B-P 2 0"
223 FORI=SI*64TOEI*64STEP64:CZ=CZ+1
224 IFCZ/4=INT(CZ/4)THENGOSUB286:PRINT#15,"U1 2 0";TT;SS:PRINT#15,"B-P 2 0"
225 FORK=0TO63
226 GET#2,DT$:DT=ASC(DT$+CHR$(0))
227 POKEDB+I+K,DT:NEXTK:NEXTI
228 RETURN
229 PRINT#15,"B-P 2 0"
230 FORI=SI*64TOEI*64STEP64
231 FORK=0TO63
232 DT=PEEK(DB+I+K):DT$=CHR$(DT)
233 PRINT#2,DT$;:NEXTK:CZ=CZ+1
234 IFCZ/4=INT(CZ/4)THENPRINT#15,"U2 2 0";TT;SS:PRINT#15,"B-P 2 0":GOSUB286
235 NEXTI:IFCZ/4<>INT(CZ/4)THENPRINT#15,"U2 2 0";TT;SS
236 RETURN
237 GETZ$:IFZ$<>""THENRETURN
238 GOTO237
239 FORI=SLTOELSTEPJM
240 POKEI,DT
241 IFFF=1THENPOKEI+CN,CD
242 NEXTI
243 RETURN
244 FORK=1TO2
245 GOSUB239:SL=SL+K*40-2:EL=EL+K*40+2:NEXT:GOSUB239
246 FORK=2TO1STEP-1
247 SL=SL+K*40+2:EL=EL+K*40-2:GOSUB239:NEXT
248 RETURN
249 FORK=1TOT(LT,0)STEP2:Q=K+1:DR=T(LT,K):CH=T(LT,Q)
250 IFDR>256THENDR=DR-500
251 PP=PP+DR:POKEPP,CH:POKEPP+CN,14*RND(1)+2
252 NEXTK
253 RETURN
254 FORTT=0TODR:NEXT
255 RETURN
256 XX=SL:SL=EL:EL=XX:JM=-JM
257 CD=INT(16*RND(1)):IFCD=LCORCD=BGTHEN257
258 GOSUB239:LC=CD
259 RETURN
260 PRINT"                                        ";
261 RETURN
262 RC=INT(RND(1)*16):IFRC=BGTHEN262
263 POKELL+CN,RC
264 RETURN
265 POKE646,I:IFI=BGTHENPOKE646,11:PRINT""
266 EX=11-LEN(CN$(I)):PRINT"";CN$(I);
267 IFEX=0THENPRINT:RETURN
268 FORK=1TOEX:PRINT" ";:NEXT:PRINT:        RETURN
269 GOSUB284
270 FORI=0TONS:FORH=0TO20:FORK=0TO2:FORJ=7TO0STEP-1-CF:BY=DB+(FM+I)*64+H*3+K
271 L1=H*40+K*8+ABS(7-J):I1=2J:POKEB1+L1,RV:D1=(PEEK(BY)ANDI1):IFCF=0THEN273
272 L2=L1+1:I2=2(J-1):POKEB1+L2,RV:D2=(PEEK(BY)ANDI2):GOTO275
273 IFD1=I1THENPOKEB2+L1,SC(I)
274 GOTO278
275 IFD1=I1ANDD2<>I2THENPOKEB2+L1,SC(I):POKEB2+L2,SC(I)
276 IFD1<>I1ANDD2=I2THENPOKEB2+L1,A1:   POKEB2+L2,A1
277 IFD1=I1ANDD2=I2 THENPOKEB2+L1,A2:   POKEB2+L2,A2
278 NEXTJ:NEXTK:NEXTH:NEXTI
279 RETURN
280 GOSUB284:FORI=0TO(NS+1)*64-1
281 POKEDB+FM*64+I,FI:NEXT
282 FORY=0TO20:FORX=0TO23:XP=Y*40+X:POKEXP+B2,BG:POKEXP+B1,RV:NEXTX:NEXTY
283 RETURN
284 PRINT"PLEASE WAIT...                          ";
285 RETURN
286 SS=SS+1
287 IFTT<18ANDSS>20THENTT=TT+1:SS=0:        GOTO292
288 IFTT<25ANDSS>18THENTT=TT+1:SS=0:        GOTO292
289 IFTT<31ANDSS>17THENTT=TT+1:SS=0:        GOTO292
290 IFSS>16THENTT=TT+1:SS=0:GOTO292
291 RETURN
292 IFTT=18THENSS=1
293 IFTT>35THENPRINT"END OF DISK! FLIP OR REPLACE...":WAIT197,64,64:TT=1:SS=0
294 RETURN
295 PRINT"";
296 GET#15,A$:PRINTA$;:IFST<>64THEN296
297 PRINT:RETURN
298 ND=0:FORI=0TONS:ND=ND+2I:NEXT
299 RETURN
300 OPEN 15,8,15,"I"
301 INPUT "TRACK, SECTOR";T,S
302 PRINT# 15,"B-A 0";T;S
303 GOSUB 295
304 GOTO301
305 REM * TITLE SCREEN ANIMATION *
306 REM
307 DATA 1,46,0,81,1,75,-40,73,-1,64,-1,64,-1,85,40,66,40,74,1,64,1
308 DATA 64,1,73,40,66,40,75,-1,64,-1,64,-1,74,-40,85,1,46,0,81,463,66,40,66
309 DATA 40,66,40,66,40,75,-1,74,-40,73,381,91,1,64,1,73,40,66,40,75,-1,64,-1
310 DATA 91,423,66,40,66,40,75,420,91,1,64,1,73,40,75,-1,81,462,110,40,66,40
311 DATA 113,380,81,461,73,40,66,40,66,40,66,40,74,1,75,419,91,1,125,541,64,1
312 DATA 64,1,75,-40,73,-1,64,-1,64,0,114,40,113,0,91,40,125,0,113,1,64,1,75
313 DATA 463,46,0,81,1,110,40,66,40,75,-1,74,421,114,1,110,40,125,-40,114,1
314 DATA 73,40,66,40,75,-1,74,424,46,0,81,-1,64,-1,85,40,66,40,74,1,64,1,75
315 DATA -40,66,40,74,1,75
316 REM
317 REM * ORDER OF LETTERS IN TITLE *
318 REM
319 DATA 0,1,2,3,4,5,0,6,7,2,4
320 REM
321 M
322 REM      * MESSAGE STRINGS *
323 REM
324 MS$(0)="     * PRODUCED BY FRANCIS DESANY *     "
325 MS$(1)="          * SPRITESMART V1.0 *          "
326 MS$(2)="          * MARCH 10TH, 2020 *          "
327 MS$(3)="USE CRSR KEYS WITH  SPACE  BAR  TO EDIT."
328 MS$(4)="'9' & '0' REPRESENT AUX. COLORS #1 & #2."
329 MS$(5)="USE + TO EDIT AUX. #1 AND 9 TO USE IT.  "
330 MS$(6)="USE - TO EDIT AUX. #2 AND 0 TO USE IT.  "
331 MS$(7)="PRESS E TO ERASE WORK AND P TO PREVIEW. "
332 MS$(8)="PRESS S OR L TO SAVE OR LOAD IMAGES.    "
333 MS$(9)="PRESS N TO START NEW IMAGE OR Q TO QUIT."
334 RETURN
335 REM
336 REM    * COLOR PALATTE NAMES: *
337 REM
338 DATA "BLACK","WHITE","RED","CYAN","PURPLE","GREEN","BLUE","YELLOW"
339 DATA "ORANGE","BROWN","PEACH","DARK GREY","MED. GREY","LIGHT GREEN"
340 DATA "LIGHT BLUE","LIGHT GREY"
